---
const { grid = true, fill = true } = Astro.props
---

<article
  class:list={[
    { grid, fill },
    "prose dark:prose-dark prose-a:underline-offset-4 prose-a:decoration-1 prose-a:decoration-dotted leading-loose tracking-wide"
  ]}
>
  <slot />
</article>

<style>
  article.prose:has(*) {
    max-width: inherit;
  }

  .prose :global(> * > :first-child) {
    margin-top: 0;
  }

  .prose > :global(:where(h1, h2, h3, h4, h5, h6)):first-child {
    margin-top: 2em;
  }

  .prose.grid:has(*) {
    --px: 3vw;
    --py: 3vh;
    position: relative;
    padding: calc(max(var(--px), var(--py)) * 2.5);
    margin: -1rem;
  }

  .prose.grid:has(*):lang(en) {
    --px: 2vw;
    --py: 2vh;
  }

  .prose.grid:has(*)::before {
    content: "";
    position: absolute;
    inset: 0;
    z-index: -1;

    --line-color: #e8e5e3;
    background-image: linear-gradient(180deg, transparent 96%, var(--line-color) 100%),
      linear-gradient(90deg, transparent 96%, var(--line-color) 100%);
    background-size: 1em 1em;
    clip-path: inset(0 round 5em);
    -webkit-mask-origin: padding-box;
    -webkit-mask-composite: source-in;
    -webkit-mask-image: linear-gradient(
        to right,
        rgba(0, 0, 0, 0) 0%,
        white calc(var(--px) * 2),
        white calc(100% - var(--px) * 2),
        rgba(0, 0, 0, 0) 100%
      ),
      linear-gradient(
        to bottom,
        rgba(0, 0, 0, 0) 0%,
        white calc(var(--py) * 2),
        white calc(100% - var(--py) * 2),
        rgba(0, 0, 0, 0) 100%
      );
  }

  :global(.dark) .prose.grid:has(*)::before {
    --line-color: #475569;
    background-color: transparent;
  }

  .prose.fill:has(*)::before {
    background-color: #f4f6ff;
  }

  :global(.dark) .prose.fill:has(*)::before {
    background-color: transparent;
  }
</style>
